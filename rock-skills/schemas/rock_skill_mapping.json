{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "ROCK Skill Mapping Schema",
  "description": "Schema for mapping ROCK skills to base skills + specifications",
  "type": "object",
  "properties": {
    "rock_skill_id": {
      "type": "string",
      "pattern": "^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$",
      "description": "UUID of the ROCK skill"
    },
    "rock_skill_name": {
      "type": "string",
      "description": "Full name of the ROCK skill"
    },
    "base_skill_id": {
      "type": "string",
      "pattern": "^BS-[0-9]{3,}$",
      "description": "Base skill this ROCK skill maps to"
    },
    "specifications": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "spec_type": {
            "type": "string",
            "description": "Type of specification (e.g., 'text_type', 'complexity_band')"
          },
          "spec_value": {
            "type": "string",
            "description": "Value of the specification (e.g., 'fictional', 'K-2')"
          },
          "spec_confidence": {
            "type": "string",
            "enum": ["high", "medium", "low"],
            "description": "Confidence in this specification assignment"
          }
        },
        "required": ["spec_type", "spec_value"]
      },
      "description": "Array of specifications applied to this ROCK skill"
    },
    "variant_classification": {
      "type": "object",
      "properties": {
        "state_a_group_id": {
          "type": ["string", "null"],
          "description": "Cross-state variant group ID"
        },
        "state_b_chain_id": {
          "type": ["string", "null"],
          "description": "Grade progression chain ID"
        },
        "is_spiral_skill": {
          "type": "boolean",
          "description": "Whether this is part of a progression chain"
        },
        "prerequisite_skill_id": {
          "type": ["string", "null"],
          "description": "ROCK skill ID of the prerequisite in progression"
        },
        "complexity_level": {
          "type": "integer",
          "minimum": 0,
          "maximum": 14,
          "description": "Numeric complexity level (0=Pre-K, 13=Grade 12)"
        }
      }
    },
    "extraction_metadata": {
      "type": "object",
      "properties": {
        "extraction_method": {
          "type": "string",
          "enum": ["llm_classification", "rule_based", "hybrid", "manual"],
          "description": "How the mapping was created"
        },
        "extraction_confidence": {
          "type": "string",
          "enum": ["high", "medium", "low"],
          "description": "Overall confidence in the mapping"
        },
        "extraction_timestamp": {
          "type": "string",
          "format": "date-time"
        },
        "human_validated": {
          "type": "boolean",
          "description": "Whether a human has reviewed and validated this mapping"
        },
        "validation_notes": {
          "type": "string",
          "description": "Human validator notes"
        },
        "llm_reasoning": {
          "type": "string",
          "description": "LLM's explanation for the mapping"
        }
      },
      "required": ["extraction_method", "extraction_confidence", "human_validated"]
    },
    "redundancy_flags": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "flag_type": {
            "type": "string",
            "enum": ["potential_duplicate", "ambiguous_phrasing", "unclear_specification"],
            "description": "Type of redundancy flag"
          },
          "related_skill_id": {
            "type": "string",
            "description": "ID of the skill this might be redundant with"
          },
          "similarity_score": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "description": "Semantic similarity score"
          },
          "recommendation": {
            "type": "string",
            "description": "Suggested action (merge, clarify, keep separate)"
          }
        }
      },
      "description": "Redundancy detection flags"
    }
  },
  "required": [
    "rock_skill_id",
    "rock_skill_name",
    "base_skill_id",
    "specifications",
    "extraction_metadata"
  ]
}

